
{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="{% static 'listings/assets/img/logo-ocp.png' %}" >
  <link rel="icon" type="image/png" href="{% static 'listings/assets/img/logo-ocp.png' %}" >
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-...your-integrity-hash..." crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-...your-integrity-hash..." crossorigin="anonymous"></script>

  <title>
    MyOCP
  </title>
  <!--     Fonts and icons     -->
       <!-- Include Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <!-- Include jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <!-- Include Popper.js -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
  <!-- Include Bootstrap JavaScript -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

  <!-- Nucleo Icons -->
  <link href="{% static 'listings/assets/css/nucleo-icons.css' %}" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="{% static 'listings/assets/css/nucleo-svg.css' %}" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <link href="{% static 'listings/assets/css/nucleo-svg.css' %}" rel="stylesheet" />
  <!-- CSS Files -->
  <link id="pagestyle" href="{% static 'listings/assets/css/soft-ui-dashboard.css' %}"  rel="stylesheet" />
</head>
<body class="g-sidenav-show bg-gray-100">
    <main class="main-content position-relative max-height-vh-100 h-100 mt-1 border-radius-lg">
        <div class="container-fluid py-4">
            <!-- Notifications -->
            <div>
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} alert-dismissible fade show mt-2" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>

            <!-- Statistics Cards -->
            <div class="row">
                <!-- Completion Rate -->
                <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
                    <div class="card">
                        <div class="card-body p-3">
                            <div class="row">
                                <div class="col-8">
                                    <div class="numbers">
                                        <p class="text-sm mb-0 text-capitalize font-weight-bold">Taux de Complétion</p>
                                        <h5 class="font-weight-bolder">
                                            {{ completion_rate }}%
                                        </h5>
                                    </div>
                                </div>
                                <div class="col-4 text-end">
                                    <div class="icon icon-shape bg-gradient-primary shadow text-center border-radius-md">
                                        <i class="bi bi-check2-circle text-lg" style="font-size: 40px;"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Total Courses -->
                <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
                    <div class="card">
                        <div class="card-body p-3">
                            <div class="row">
                                <div class="col-8">
                                    <div class="numbers">
                                        <p class="text-sm mb-0 text-capitalize font-weight-bold">Nombre de Cours</p>
                                        <h5 class="font-weight-bolder">
                                            {{ total_courses }}
                                        </h5>
                                    </div>
                                </div>
                                <div class="col-4 text-end">
                                    <div class="icon icon-shape bg-gradient-success shadow text-center border-radius-md">
                                        <i class="bi bi-journal-text text-lg" style="font-size: 40px;"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gained/Required Skills -->
                <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
                    <div class="card">
                        <div class="card-body p-3">
                            <div class="row">
                                <div class="col-8">
                                    <div class="numbers">
                                        <p class="text-sm mb-0 text-capitalize font-weight-bold">Compétences Acquises / Requises</p>
                                        <h5 class="font-weight-bolder">
                                            {{ skills_comparison.gained }} / {{ skills_comparison.required }}
                                        </h5>
                                    </div>
                                </div>
                                <div class="col-4 text-end">
                                    <div class="icon icon-shape bg-gradient-warning shadow text-center border-radius-md">
                                        <i class="bi bi-lightbulb text-lg" style="font-size: 40px;"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Professors with Courses -->
                <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
                    <div class="card">
                        <div class="card-body p-3">
                            <div class="row">
                                <div class="col-8">
                                    <div class="numbers">
                                        <p class="text-sm mb-0 text-capitalize font-weight-bold">Professeurs avec Cours</p>
                                        <h5 class="font-weight-bolder">
                                            {{ professor_working_days|length }}
                                        </h5>
                                    </div>
                                </div>
                                <div class="col-4 text-end">
                                    <div class="icon icon-shape bg-gradient-danger shadow text-center border-radius-md">
                                        <i class="bi bi-person-check text-lg" style="font-size: 40px;"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
<!-- Courses by Department -->
<div class="col-lg-6 mb-lg-4 mb-4">
    <div class="card z-index-2">
        <div class="card-body p-3">
            <canvas id="coursesByDepartmentChart"></canvas>
        </div>
    </div>
</div>

<!-- Courses by Year -->
<div class="col-lg-6 mb-lg-4 mb-4">
    <div class="card z-index-2">
        <div class="card-body p-3">
            <canvas id="coursesByYearChart"></canvas>
        </div>
    </div>
</div>

            <!-- Charts Section -->
            <div class="row mt-4">
                <!-- Courses by Department -->
                <div class="col-lg-6 mb-lg-4 mb-4">
                    <div class="card z-index-2">
                        <div class="card-body p-3">
                            <canvas id="coursesByDepartmentChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Courses by Year -->
                <div class="col-lg-6 mb-lg-4 mb-4">
                    <div class="card z-index-2">
                        <div class="card-body p-3">
                            <canvas id="coursesByYearChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- ChartJS Script -->
    <script src="{% static 'assets/js/plugins/chartjs.min.js' %}"></script>
    <script>
       // Courses by Department Chart
const coursesByDepartmentData = JSON.parse('{{ courses_by_department_data|escapejs }}');
new Chart(document.getElementById('coursesByDepartmentChart'), {
    type: 'pie',
    data: {
        labels: coursesByDepartmentData.labels,
        datasets: [{
            data: coursesByDepartmentData.counts,
            backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4CAF50', '#FFC107']
        }]
    }
});

// Courses by Year Chart
const coursesByYearData = JSON.parse('{{ courses_by_year_data|escapejs }}');
new Chart(document.getElementById('coursesByYearChart'), {
    type: 'line',
    data: {
        labels: coursesByYearData.years,
        datasets: [{
            label: 'Courses Offered',
            data: coursesByYearData.counts,
            borderColor: '#4CAF50',
            fill: false
        }]
    }
});
    </script>

    <!-- Styling -->
    <style>
        .table-hover tbody tr:hover {
            background-color: #f5f5f5;
        }
        thead th {
            background-color: #343a40;
            color: #ffffff;
            text-transform: uppercase;
        }
        .table-bordered th, .table-bordered td {
            border: 1px solid #dee2e6;
        }
    </style>
</body>
</html>